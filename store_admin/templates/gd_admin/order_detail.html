{% extends "gd_admin/base.html" %}
{% load static %}

{% block title %}Order #{{ order.id }}{% endblock %}
{% block body_class %}dashboard-body{% endblock %}

{% block content %}
<div class="container-fluid">
  <div class="row">

    {% include "gd_admin/sidebar.html" %}

    <main class="col-lg-10 main-content">

      <!-- HEADER -->
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="page-title mb-0">
          Order #{{ order.id }}
        </h1>

        <a href="{% url 'admin_orders' %}" class="btn btn-outline-light">
          <i class="bi bi-arrow-left me-2"></i> Back to Orders
        </a>
      </div>

      <!-- ORDER INFO -->
      <div class="row mb-4">

        <div class="col-lg-6">
          <div class="glass-card">
            <h5 class="mb-3">Customer Details</h5>

            <p><strong>Name:</strong> {{ order.customer_name }}</p>
            <p><strong>Phone:</strong> {{ order.phone }}</p>
            <p><strong>Email:</strong> {{ order.email|default:"—" }}</p>
            <p><strong>Address:</strong><br>{{ order.address }}</p>
          </div>
        </div>

        <div class="col-lg-6">
          <div class="glass-card">
            <h5 class="mb-3">Order Info</h5>

            <p><strong>Status:</strong>
              <span class="badge bg-info text-dark text-uppercase">
                {{ order.status }}
              </span>
            </p>

            <p><strong>Placed On:</strong>
              {{ order.created_at|date:"d M Y, h:i A" }}
            </p>

            <!-- STATUS UPDATE -->
            <form method="post" class="mt-3">
              {% csrf_token %}
              <label class="form-label">Update Status</label>
              <div class="d-flex gap-2">
                <select name="status" class="form-select">
                  <option value="pending" {% if order.status == "pending" %}selected{% endif %}>Pending</option>
                  <option value="confirmed" {% if order.status == "confirmed" %}selected{% endif %}>Confirmed</option>
                  <option value="shipped" {% if order.status == "shipped" %}selected{% endif %}>Shipped</option>
                  <option value="completed" {% if order.status == "completed" %}selected{% endif %}>Completed</option>
                  <option value="cancelled" {% if order.status == "cancelled" %}selected{% endif %}>Cancelled</option>
                </select>

                <button class="btn btn-gold">
                  Update
                </button>
              </div>
            </form>

          </div>
        </div>

      </div>

      <!-- ORDER ITEMS -->
      <div class="glass-card">
        <h5 class="mb-3">Order Items</h5>

        <div class="table-responsive">
          <table class="table table-dark table-hover align-middle mb-0">
            <thead>
              <tr>
                <th>Product</th>
                <th>Quantity</th>
                <th>Price</th>
                <th>Total</th>
              </tr>
            </thead>

            <tbody>
              {% for item in items %}
              <tr>
                <td>{{ item.product.name }}</td>
                <td>{{ item.quantity }}</td>
                <td>₹ {{ item.price }}</td>
                <td>₹ {{ item.quantity|floatformat:0|add:"0"|floatformat }}{{ item.quantity|add:0|floatformat }}</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>

      </div>

    </main>
  </div>
</div>
{% endblock %}
